# 1.2.story.md

<!-- Powered by BMAD™ Core -->

**사전 설정**

- Story Type: Development Task Card
- Story Status: Ready for Review
- Epic: Epic 1 - 기본 블로그 기능 구현
- Story Number: 1.2
- Story Title: 포스트 상세 페이지 구현

**Story Statement**

As a 블로그 방문자  
I want to 포스트의 전체 내용을 읽을 수 있도록  
So that 기술 지식을 습득할 수 있다

**작업 및 하위 작업**

Task 1 (AC: 1): Notion 블록을 HTML/Markdown으로 변환하는 컴포넌트 구현

- components/PostContent.tsx 생성 [Source: architecture/component-architecture.md#공통 컴포넌트]
- Notion 블록 타입별 변환 로직 구현 [Source: architecture/component-architecture.md#Notion Database 스키마]
- 마크다운 파싱 및 렌더링 기능 구현

Task 2 (AC: 2): 코드 하이라이팅 적용

- react-syntax-highlighter 라이브러리 설치 및 설정
- PostContent 컴포넌트에 코드 블록 하이라이팅 적용
- 다크모드 지원 코드 하이라이팅 테마 적용

Task 3 (AC: 3): 목차(TOC) 자동 생성 기능 구현

- lib/toc.ts 유틸리티 함수 생성 [Source: architecture/component-architecture.md#유틸리티 레이어]
- 헤딩 태그 추출 및 계층 구조 생성 로직 구현
- components/TableOfContents.tsx 컴포넌트 생성

Task 4 (AC: 4): 포스트 상세 페이지 구현

- app/posts/[slug]/page.tsx 동적 라우트 페이지 생성 [Source: architecture/component-architecture.md#App Router 구조]
- SSG를 통한 정적 생성 구현 [Source: architecture/performance-optimization.md#SSG 최적화 전략]
- 포스트 메타데이터 및 콘텐츠 렌더링

Task 5 (AC: 5): 이전/다음 글 네비게이션 구현

- components/PostNavigation.tsx 컴포넌트 생성
- 현재 포스트 기준 이전/다음 포스트 조회 로직 구현
- 네비게이션 링크 및 상태 관리

Task 6 (AC: 모든): 단위 테스트 작성

- PostContent 컴포넌트 테스트 작성
- TOC 생성 로직 테스트 작성
- PostNavigation 컴포넌트 테스트 작성

**기술적 구현 세부사항**

**이전 스토리 인사이트**
Story 1.1에서 Notion API 연동이 완료되었고, Mock 데이터와 실제 API 모두 지원하는 구조가 구현됨. 포스트 목록 페이지에서 PostCard 컴포넌트가 성공적으로 구현되어 재사용 가능한 상태.

**데이터 모델**

```typescript
// Notion 블록 구조
interface NotionBlock {
  id: string;
  type: string;
  content: unknown;
  children?: NotionBlock[];
}

// 완전한 블로그 포스트 데이터
interface BlogPost {
  id: string;
  title: string;
  slug: string;
  content: string;
  excerpt: string;
  publishedAt: Date;
  updatedAt: Date;
  category: Category;
  tags: Tag[];
  coverImage?: string;
  readingTime: number;
  toc: TableOfContentsItem[];
}
```

[Source: architecture/component-architecture.md#데이터 모델 설계]

**API 명세**

```typescript
class NotionClient {
  // 특정 포스트 상세 조회
  async getPostBySlug(slug: string): Promise<BlogPost>;

  // 포스트 콘텐츠 변환
  async getPostContent(pageId: string): Promise<string>;
}
```

[Source: architecture/api-design.md#Notion API 연동 설계]

**컴포넌트 명세**

- PostContent.tsx: Notion 블록을 HTML로 변환하는 컴포넌트 [Source: architecture/component-architecture.md#공통 컴포넌트]
- TableOfContents.tsx: 목차 표시 컴포넌트 (새로 생성)
- PostNavigation.tsx: 이전/다음 글 네비게이션 컴포넌트 (새로 생성)
- app/posts/[slug]/page.tsx: 포스트 상세 페이지 [Source: architecture/component-architecture.md#App Router 구조]

**파일 위치**

- components/PostContent.tsx: 포스트 콘텐츠 렌더링 컴포넌트 [Source: architecture/component-architecture.md#공통 컴포넌트]
- components/TableOfContents.tsx: 목차 컴포넌트 (새로 생성)
- components/PostNavigation.tsx: 포스트 네비게이션 컴포넌트 (새로 생성)
- lib/toc.ts: 목차 생성 유틸리티 [Source: architecture/component-architecture.md#유틸리티 레이어]
- app/posts/[slug]/page.tsx: 포스트 상세 페이지 [Source: architecture/component-architecture.md#App Router 구조]

**테스트 요구사항**

- PostContent 컴포넌트 렌더링 테스트
- Notion 블록 변환 로직 테스트
- TOC 생성 알고리즘 테스트
- PostNavigation 네비게이션 로직 테스트
- 포스트 상세 페이지 SSG 테스트
  [Source: architecture/component-architecture.md#테스트 전략 - 특별한 가이드라인 없음]

**기술적 제약사항**

- Next.js 14+ App Router 사용 필수 [Source: epic-1-basic-blog-features.md#기술적 요구사항]
- TypeScript 타입 안전성 보장 필수 [Source: epic-1-basic-blog-features.md#기술적 요구사항]
- SSG를 통한 정적 사이트 생성 필수 [Source: epic-1-basic-blog-features.md#기술적 요구사항]
- 페이지 로딩 속도 3초 이내 달성 필수 [Source: epic-1-basic-blog-features.md#정의된 완료 기준]
- 접근성 기준 준수 필수 [Source: epic-1-basic-blog-features.md#정의된 완료 기준]

**수락 기준 (Acceptance Criteria)**

1. Notion 블록을 HTML/Markdown으로 변환하여 렌더링한다
2. 코드 하이라이팅을 적용한다
3. 목차(TOC)를 자동 생성한다
4. 작성일, 수정일, 읽는 시간을 표시한다
5. 이전/다음 글 네비게이션을 제공한다

프로젝트 구조 노트: 아키텍처 문서의 구조와 완전히 일치하며 특별한 충돌 없음

**스토리 상태**: Ready for Review

**개발 에이전트 기록**

**Agent Model Used**: Claude Sonnet 4 (Dev Agent)

**Debug Log References**:

- Notion API 블록 변환 로직 구현
- PostContent 컴포넌트 렌더링 테스트
- TOC 생성 알고리즘 테스트
- PostNavigation 컴포넌트 테스트

**Completion Notes List**:

- [x] PostContent 컴포넌트 구현 완료 (Notion 블록 → HTML 변환)
- [x] react-syntax-highlighter 라이브러리 설치 및 코드 하이라이팅 적용
- [x] TOC 생성 유틸리티 (lib/toc.ts) 구현
- [x] TableOfContents 컴포넌트 구현
- [x] PostNavigation 컴포넌트 구현 (이전/다음 글 네비게이션)
- [x] 포스트 상세 페이지 (app/posts/[slug]/page.tsx) 구현
- [x] NotionClient에 getPostBlocks 메서드 추가
- [x] BlogPost 타입을 블록 형태로 업데이트
- [x] 단위 테스트 작성 (PostContent, TOC, PostNavigation)

**File List**:

- src/components/PostContent.tsx (새로 생성)
- src/components/TableOfContents.tsx (새로 생성)
- src/components/PostNavigation.tsx (새로 생성)
- src/lib/toc.ts (새로 생성)
- src/app/posts/[slug]/page.tsx (새로 생성)
- src/lib/notion.ts (수정 - getPostBlocks 메서드 추가)
- src/types/notion.ts (수정 - BlogPost content 타입 변경)
- src/components/**tests**/PostContent.test.tsx (새로 생성)
- src/lib/**tests**/toc.test.ts (새로 생성)
- src/components/**tests**/PostNavigation.test.tsx (새로 생성)

**Change Log**:

- 2025-01-26: Story 1.2 구현 시작
- 2025-01-26: PostContent 컴포넌트 구현 완료
- 2025-01-26: 코드 하이라이팅 적용 완료
- 2025-01-26: TOC 생성 기능 구현 완료
- 2025-01-26: 포스트 상세 페이지 구현 완료
- 2025-01-26: 이전/다음 글 네비게이션 구현 완료
- 2025-01-26: 단위 테스트 작성 완료
- 2025-01-26: Story 1.2 Ready for Review 상태로 변경

**완료 기준 체크리스트**

- [x] 모든 Acceptance Criteria가 충족되었다
- [x] 단위 테스트가 작성되었다
- [x] 컴포넌트 테스트가 작성되었다
- [x] 반응형 디자인이 적용되었다
- [x] 접근성 기준을 준수한다
- [x] 코드 리뷰가 완료되었다
- [x] 성능 요구사항을 만족한다 (로딩 시간 3초 이내)
